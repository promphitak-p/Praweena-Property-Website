<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>Dashboard - Praweena Admin</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="/assets/css/pp-theme.css">
  <script>
    window.SUPABASE_URL = window.SUPABASE_URL || "https://YOUR-PROJECT.supabase.co";
    window.SUPABASE_ANON_KEY = window.SUPABASE_ANON_KEY || "YOUR-ANON-KEY";
  </script>
  <script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.js" defer></script>
  <script src="/js/init-supabase.js" defer></script>
  <style>
    .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
    .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .nav{display:flex;gap:8px;flex-wrap:wrap}
    .nav button{padding:8px 12px;border-radius:10px;border:1px solid #e5e7eb;background:#fff}
    .section{margin-top:16px}
    table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 18px rgba(0,0,0,.08)}
    th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}
    th{background:#fafafa}
    .actions button{margin-right:6px}
    .form-grid{display:grid;gap:8px;grid-template-columns:repeat(2,1fr)}
    .form-grid input, .form-grid textarea{padding:10px;border:1px solid #e5e7eb;border-radius:10px}
    .form-grid textarea{grid-column:1/-1;min-height:90px}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;padding:16px}
    .modal .panel{background:#fff;padding:16px;border-radius:16px;max-width:720px;width:100%}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <h1>Praweena Admin</h1>
      <div>
        <button id="btn-new" class="btn-primary">+ เพิ่มทรัพย์</button>
        <button id="btn-logout" class="btn-secondary" style="background:#1F2937;color:#fff">ออกจากระบบ</button>
      </div>
    </div>

    <div class="nav">
      <button data-tab="properties">ทรัพย์สิน</button>
      <button data-tab="leads">Leads</button>
      <button data-tab="storage">อัปโหลดรูป</button>
    </div>

    <div id="tab-properties" class="section">
      <div style="margin:8px 0; display:flex; gap:8px; flex-wrap:wrap;">
        <input id="p-q" placeholder="ค้นหา (ชื่อ/ทำเล)" />
        <select id="p-published">
          <option value="">ทุกสถานะ</option>
          <option value="true">เผยแพร่</option>
          <option value="false">ซ่อน</option>
        </select>
        <button id="p-refresh">รีเฟรช</button>
      </div>
      <div id="p-list"></div>
    </div>

    <div id="tab-leads" class="section" style="display:none">
      <button id="l-refresh">รีเฟรช</button>
      <div id="l-list" style="margin-top:8px"></div>
    </div>

    <div id="tab-storage" class="section" style="display:none">
      <input type="file" id="file" accept="image/*">
      <button id="btn-upload">อัปโหลด</button>
      <div id="upload-result" class="notice" style="margin-top:8px" hidden></div>
    </div>
  </div>

  <div class="modal" id="modal">
    <div class="panel">
      <h3 id="modal-title">เพิ่ม/แก้ไขทรัพย์</h3>
      <form id="prop-form" class="form-grid">
        <input name="id" type="hidden">
        <input name="title" placeholder="ชื่อบ้าน/โครงการ" required>
        <input name="location" placeholder="ทำเล/ย่าน">
        <input name="price" type="number" placeholder="ราคา (บาท)" required>
        <input name="beds" type="number" placeholder="ห้องนอน">
        <input name="baths" type="number" placeholder="ห้องน้ำ">
        <input name="area" type="number" step="any" placeholder="พื้นที่ (ตร.ว.)">
        <input name="lat" type="number" step="any" placeholder="ละติจูด">
        <input name="lng" type="number" step="any" placeholder="ลองจิจูด">
        <input name="slug" placeholder="slug (ลิงก์)">
        <input name="cover" placeholder="URL รูปหน้าปก">
        <textarea name="desc" placeholder="คำอธิบาย (ถ้ามีคอลัมน์นี้ใน DB จะบันทึกให้ ถ้าไม่มีก็ข้าม)"></textarea>
        <label><input type="checkbox" name="published"> เผยแพร่</label>
        <div style="grid-column:1/-1;display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
          <button type="button" id="btn-cancel">ยกเลิก</button>
          <button type="submit" class="btn-primary">บันทึก</button>
        </div>
      </form>
    </div>
  </div>

  <script src="/js/uploader.js" defer></script>
  <script src="/js/dashboard.js" defer></script>
</body>
</html>
