<!-- contract-form.html -->
<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8" />
  <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏±‡∏ç‡∏ç‡∏≤ - Praweena Property</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- App CSS -->
  <link rel="stylesheet" href="/assets/css/base.css" />
  <link rel="stylesheet" href="/assets/css/layout.css" />
  <link rel="stylesheet" href="/assets/css/components.css" />
  <link rel="stylesheet" href="/assets/css/style.css" />

  <style>
    /* --- Contract page specific --- */
    .page-header {
      margin-bottom: 1.25rem;
    }

    .page-header h1 {
      font-size: 1.6rem;
      margin-bottom: .25rem;
    }

    .text-muted {
      color: var(--text-light);
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 1rem;
    }

    .form-grid .col-span-2 {
      grid-column: span 2;
    }

    @media (max-width:768px) {
      .form-grid {
        grid-template-columns: 1fr;
      }

      .form-grid .col-span-2 {
        grid-column: span 1;
      }
    }

    /* --- Autocomplete dropdown --- */
    .ac-wrap {
      position: relative;
    }

    .ac-list {
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      background: #fff;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      box-shadow: var(--shadow-md);
      max-height: 260px;
      overflow: auto;
      z-index: 50;
      display: none;
      margin-top: .35rem;
    }

    .ac-list.open {
      display: block;
    }

    .ac-item {
      padding: .6rem .75rem;
      cursor: pointer;
      font-size: .95rem;
    }

    .ac-item+.ac-item {
      border-top: 1px solid var(--border-color);
    }

    .ac-item:hover {
      background: #fafafa;
    }

    .ac-item small {
      color: var(--text-light);
      font-size: .8rem;
    }

    /* --- Preview overlay (Export PDF) --- */
    #contract-preview-modal.modal {
      position: fixed;
      inset: 0;
      display: none;
      background: rgba(0, 0, 0, .55);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 3vh 3vw;
    }

    #contract-preview-modal.open {
      display: flex;
    }

    #contract-preview-modal .modal-content {
      width: min(980px, 96vw);
      max-height: 94vh;
      overflow: auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: var(--shadow-md);
      position: relative;
      padding: 1.25rem 1.5rem;
    }

    #contract-preview-modal .modal-close {
      position: absolute;
      right: 12px;
      top: 10px;
      font-size: 1.6rem;
      cursor: pointer;
      color: #555;
      background: #fff;
      border-radius: 999px;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-sm);
    }

    #contract-preview {
      font-size: .95rem;
      color: #111;
      line-height: 1.7;
    }

    #contract-preview h2 {
      margin: .25rem 0 .75rem;
    }

    #contract-preview .pv-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: .75rem 1rem;
    }

    #contract-preview .pv-grid .pv-row {
      border-bottom: 1px dashed #eee;
      padding-bottom: .35rem;
    }

    #contract-preview .pv-label {
      color: #666;
      font-size: .85rem;
    }

    #contract-preview .pv-value {
      font-weight: 600;
    }

    @media print {
      body {
        background: #fff;
      }

      #contract-preview-modal {
        position: static;
        inset: auto;
        background: none;
        padding: 0;
      }

      #contract-preview-modal .modal-content {
        box-shadow: none;
        max-height: none;
      }

      #contract-preview-modal .modal-close,
      #preview-actions {
        display: none !important;
      }
    }
  </style>
</head>

<body>
  <!-- üîπ ‡πÉ‡∏´‡πâ load-header.js ‡∏°‡∏≤‡πÅ‡∏ó‡∏ô header ‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß -->
  <div id="app-header"></div>

  <main class="page page-contract">
    <div class="container">

      <header class="page-header">
        <h1>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏±‡∏ç‡∏ç‡∏≤</h1>
        <p class="text-muted">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡πâ‡∏≤‡∏ô ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏±‡∏ç‡∏ç‡∏≤ ‡πÅ‡∏•‡∏∞ Export PDF ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</p>
        <p id="contract-lead-info" class="text-muted" style="margin-top:.35rem;font-size:.9rem;">
          ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
        </p>
      </header>

      <!-- 1) ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ -->
      <section class="card" style="margin-bottom:1rem;">
        <div class="card-header">
          <h2>1) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h2>
        </div>
        <div class="card-body form-grid">

          <div class="form-group col-span-2 ac-wrap">
            <label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏ä‡∏∑‡πà‡∏≠/‡πÄ‡∏ö‡∏≠‡∏£‡πå/‡∏≠‡∏µ‡πÄ‡∏°‡∏•)</label>
            <input id="lead-search" type="text" class="form-control" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">
            <div id="lead-ac" class="ac-list"></div>
          </div>

          <input type="hidden" id="lead_id">

          <div class="form-group">
            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
            <input id="lead_name" type="text" class="form-control" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
          </div>

          <div class="form-group">
            <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
            <input id="lead_phone" type="text" class="form-control" placeholder="0xx-xxx-xxxx">
          </div>

          <div class="form-group">
            <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
            <input id="lead_email" type="email" class="form-control" placeholder="example@email.com">
          </div>

          <div class="form-group">
            <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
            <input id="lead_idcard" type="text" class="form-control" placeholder="x-xxxx-xxxxx-xx-x">
          </div>

          <div class="form-group col-span-2">
            <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
            <textarea id="lead_address" class="form-control" rows="2"
              placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£"></textarea>
          </div>

        </div>
      </section>

      <!-- 2) ‡∏ö‡πâ‡∏≤‡∏ô -->
      <section class="card" style="margin-bottom:1rem;">
        <div class="card-header">
          <h2>2) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡πâ‡∏≤‡∏ô</h2>
        </div>
        <div class="card-body form-grid">

          <div class="form-group col-span-2">
            <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡πâ‡∏≤‡∏ô (‡∏à‡∏≤‡∏Å Properties)</label>
            <select id="property_id" class="form-control">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡πâ‡∏≤‡∏ô --</option>
            </select>
          </div>

          <div class="form-group">
            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô/‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
            <input id="property_name" type="text" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡∏ß‡∏±‡∏á‡πÄ‡∏û‡∏ä‡∏£">
          </div>

          <div class="form-group">
            <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)</label>
            <input id="property_price" type="number" class="form-control" placeholder="0">
          </div>

          <div class="form-group col-span-2">
            <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô</label>
            <textarea id="property_address" class="form-control" rows="2"></textarea>
          </div>

        </div>
      </section>

      <!-- 3) ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤ -->
      <section class="card" style="margin-bottom:1rem;">
        <div class="card-header">
          <h2>3) ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤</h2>
        </div>
        <div class="card-body form-grid">

          <input type="hidden" id="contract_id">

          <div class="form-group">
            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤</label>
            <input id="contract_date" type="date" class="form-control">
          </div>

          <div class="form-group">
            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ç‡∏ç‡∏≤</label>
            <select id="contract_type" class="form-control">
              <option value="reservation">‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏à‡∏≠‡∏á</option>
              <option value="sale">‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢</option>
              <option value="lease">‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏ä‡πà‡∏≤</option>
            </select>
          </div>

          <div class="form-group">
            <label>‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≠‡∏á/‡∏°‡∏±‡∏î‡∏à‡∏≥ (‡∏ö‡∏≤‡∏ó)</label>
            <input id="deposit_amount" type="number" class="form-control" placeholder="0">
          </div>

          <div class="form-group">
            <label>‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß (‡∏ö‡∏≤‡∏ó)</label>
            <input id="paid_amount" type="number" class="form-control" placeholder="0">
          </div>

          <div class="form-group">
            <label>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡∏ö‡∏≤‡∏ó)</label>
            <input id="remain_amount" type="number" class="form-control" placeholder="0" readonly>
          </div>

          <div class="form-group">
            <label>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏≠‡∏ô/‡∏ô‡∏±‡∏î‡πÄ‡∏ã‡πá‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÉ‡∏´‡∏ç‡πà</label>
            <input id="transfer_date" type="date" class="form-control">
          </div>

          <div class="form-group col-span-2">
            <label>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
            <textarea id="contract_note" class="form-control" rows="3"
              placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏Å‡∏π‡πâ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£..., ‡∏ô‡∏±‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏≠‡∏ô..., ‡∏Ø‡∏•‡∏Ø"></textarea>
          </div>

        </div>
      </section>

      <!-- Actions -->
      <div style="display:flex;gap:.75rem;flex-wrap:wrap;margin:1rem 0 2rem;">
        <button id="save-contract-btn" class="btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏±‡∏ç‡∏ç‡∏≤</button>
        <button id="preview-contract-btn" class="btn btn-secondary">‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß / Export PDF</button>
        <a href="/admin/contract-list.html" class="btn btn-secondary">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏ç‡∏ç‡∏≤</a>
      </div>

    </div>
  </main>

  <!-- Preview Modal -->
  <div id="contract-preview-modal" class="modal">
    <div class="modal-content">
      <button class="modal-close" id="preview-close">‚úï</button>

      <div id="preview-actions" style="display:flex;gap:.5rem;justify-content:flex-end;margin-bottom:.75rem;">
        <button id="print-btn" class="btn">‡∏û‡∏¥‡∏°‡∏û‡πå / Save PDF</button>
      </div>

      <div id="contract-preview"></div>
    </div>
  </div>

  <!-- ‡πÇ‡∏´‡∏•‡∏î header -->
  <script type="module" src="/js/layout/load-header.js"></script>
  <!-- Page JS -->
  <script type="module" src="/js/pages/contract-form.page.js"></script>
</body>

</html>